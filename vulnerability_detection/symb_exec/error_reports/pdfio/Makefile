.POSIX:

# Variables
CC		=	cc
AR		=	ar
ARFLAGS		=	rvs
CFLAGS		=	-O0 -g
COMMONFLAGS	=	-Wall
CPPFLAGS	=	'-DPDFIO_VERSION="$(VERSION)"'
VERSION		=	1.1.1
prefix		=	/usr/local

# Base rules
.SUFFIXES:	.c .h .o
%.o: %.c
	echo Compiling $<...
	$(CC) $(CFLAGS) $(CPPFLAGS) $(COMMONFLAGS) -c $<

# Files
COMMON_OBJS		=	pdfio-aes.o \
				pdfio-array.o \
				pdfio-common.o \
				pdfio-content.o \
				pdfio-crypto.o \
				pdfio-dict.o \
				pdfio-file.o \
				pdfio-md5.o \
				pdfio-object.o \
				pdfio-page.o \
				pdfio-rc4.o \
				pdfio-sha256.o \
				pdfio-stream.o \
				pdfio-string.o \
				pdfio-token.o \
				pdfio-value.o \
				ttf.o

# Target
TARGET			=	pdfiototext

# Make everything
all:		$(TARGET)

# Clean everything
clean:
	echo Cleaning...
	rm -f $(TARGET) $(COMMON_OBJS) pdfiototext.o

# pdfio text extraction (demo, doesn't handle a lot of things yet)
pdfiototext:	pdfiototext.o $(COMMON_OBJS)
	echo Linking $@...
	$(CC) $(COMMONFLAGS) -o $@ pdfiototext.o $(COMMON_OBJS) -lm -lz

# Dependencies
$(COMMON_OBJS):	pdfio.h pdfio-private.h Makefile
pdfio-content.o:	pdfio-content.h ttf.h
ttf.o:			ttf.h
