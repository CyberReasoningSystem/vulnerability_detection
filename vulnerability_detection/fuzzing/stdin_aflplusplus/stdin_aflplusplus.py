from commons.input_streams import InputStreams
from vulnerability_detection.fuzzing.abstract_aflplusplus import (
    AFLPlusPlus,
    SessionFolderStructure,
)


class StdinAFLPlusPlus(AFLPlusPlus):
    __SUPPORTED_INPUT_STREAMS = [
        InputStreams.STDIN,
    ]

    def __init__(self) -> None:
        super().__init__(self.__SUPPORTED_INPUT_STREAMS)

    def _create_additional_folder_structure(
        self, structure: SessionFolderStructure
    ) -> None:
        pass

    def _get_fuzzing_command(self) -> None:
        arguments = self._get_target_args_as_string()

        return (
            "./afl-fuzz -i /target/sample_inputs -o /target/analysis -Q"
            f" /target/source/binary {arguments}"
        )
