from vulnerability_detection.fuzzing.abstract_aflplusplus import (
    AFLPlusPlus,
    SessionFolderStructure,
)
from vulnerability_detection.crash_core.input_streams import InputStream


class FilesAFLPlusPlus(AFLPlusPlus):
    __SUPPORTED_INPUT_STREAMS = [
        InputStream.FILES,
    ]
    __arguments: str

    def __init__(
        self,
        arguments: str,
    ) -> None:
        super().__init__(self.__SUPPORTED_INPUT_STREAMS)

        self.__arguments = arguments

    def _create_additional_folder_structure(
        self, structure: SessionFolderStructure
    ) -> None:
        pass

    def _get_fuzzing_command(self) -> None:
        return (
            "./afl-fuzz -i /target/sample_inputs -o /target/analysis -Q"
            f" /target/source/binary {self.__arguments} @@"
        )
