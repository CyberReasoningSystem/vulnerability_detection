from vulnerability_detection.fuzzing.aflplusplus import (
    AFLPlusPlus,
    SessionFolderStructure,
)
from vulnerability_detection.fuzzing.input_streams import InputStream


class FilesAFLPlusPlus(AFLPlusPlus):
    __SUPPORTED_INPUT_STREAMS = [
        InputStream.FILES,
    ]

    def __init__(
        self,
        format_string: str,  # pylint: disable=unused-argument
    ) -> None:
        super().__init__(self.__SUPPORTED_INPUT_STREAMS)

    def _create_additional_folder_structure(
        self, structure: SessionFolderStructure
    ) -> None:
        pass

    def _get_fuzzing_command(self) -> None:
        # TODO: Place command
        return (
            "./afl-fuzz -i /target/sample_inputs -o /target/analysis -Q"
            " /target/source/binary --file @@"
        )
